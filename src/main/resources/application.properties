# Application Info
quarkus.application.name=hr-backend

# Database Configuration
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=${DB_USER:postgres}
quarkus.datasource.password=${DB_PASSWORD:password}
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/humanrsc
quarkus.datasource.jdbc.min-size=5
quarkus.datasource.jdbc.max-size=20

# Hibernate Configuration
quarkus.hibernate-orm.database.default-schema=hr_app
quarkus.hibernate-orm.log.sql=false
quarkus.hibernate-orm.sql-load-script=no-file

# Hibernate Envers Configuration
quarkus.hibernate-envers.audit-table-suffix=_aud
quarkus.hibernate-envers.revision-field-name=rev
quarkus.hibernate-envers.revision-type-field-name=revtype
quarkus.hibernate-envers.store-data-at-delete=true

# Flyway Configuration
quarkus.flyway.migrate-at-start=true
quarkus.flyway.locations=classpath:db/migration
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.schemas=hr_app
quarkus.flyway.default-schema=hr_app

# Multi-tenant Configuration
app.default-tenant=${DEFAULT_TENANT:demo-tenant}

# Auth0 Configuration
quarkus.oidc.auth-server-url=${AUTH0_DOMAIN}
quarkus.oidc.application-type=service   
# Configuración adicional para SPA
quarkus.oidc.token.audience=${AUTH0_AUDIENCE}
quarkus.oidc.roles.source=accesstoken
quarkus.oidc.roles.role-claim-path=permissions
# (opcional)
quarkus.oidc.token.principal-claim=email

# Configuración CORS para permitir requests desde React
quarkus.http.cors.origins=${FRONTEND_URL}
quarkus.http.cors.headers=accept, authorization, content-type, x-requested-with
quarkus.http.cors.methods=GET, POST, PUT, DELETE, OPTIONS

# Jackson Configuration
quarkus.jackson.write-dates-as-timestamps=false
quarkus.jackson.serialization-inclusion=non_null

# Health checks
quarkus.smallrye-health.ui.enable=true

# OpenAPI
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.path=/q/swagger-ui

# LOGGING - LIMPIO
quarkus.log.level=INFO
quarkus.log.category."com.humanrsc".level=INFO
quarkus.log.category."org.hibernate".level=WARN
quarkus.log.category."org.flyway".level=INFO
quarkus.log.category."io.agroal".level=WARN
quarkus.log.category."org.postgresql".level=WARN
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] %s%e%n

# Development profile
%dev.quarkus.log.category."com.humanrsc".level=DEBUG

# Test profile
%test.quarkus.datasource.db-kind=h2
%test.quarkus.datasource.jdbc.url=jdbc:h2:mem:testdb
%test.quarkus.hibernate-orm.database.generation=drop-and-create
%test.quarkus.flyway.migrate-at-start=false

# DEBUG SmallRye JWT desactivado para evitar ruido
quarkus.log.category."io.smallrye.jwt".level=INFO